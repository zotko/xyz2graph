
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Convert molecular .xyz files into graph representations and 3D visualizations">
      
      
      
      
        <link rel="prev" href="../getting-started/">
      
      
        <link rel="next" href="../cli/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Python API - xyz2graph</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="xyz2graph" class="md-header__button md-logo" aria-label="xyz2graph" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            xyz2graph
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Python API
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zotko/xyz2graph" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="xyz2graph" class="md-nav__button md-logo" aria-label="xyz2graph" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    xyz2graph
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zotko/xyz2graph" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Python API
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Python API
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph" class="md-nav__link">
    <span class="md-ellipsis">
      MolGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MolGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.filter" class="md-nav__link">
    <span class="md-ellipsis">
      filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.formula" class="md-nav__link">
    <span class="md-ellipsis">
      formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.read_xyz" class="md-nav__link">
    <span class="md-ellipsis">
      read_xyz
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.set_default_color" class="md-nav__link">
    <span class="md-ellipsis">
      set_default_color
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.set_element_color" class="md-nav__link">
    <span class="md-ellipsis">
      set_element_color
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.set_element_radius" class="md-nav__link">
    <span class="md-ellipsis">
      set_element_radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.to_networkx" class="md-nav__link">
    <span class="md-ellipsis">
      to_networkx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.to_plotly" class="md-nav__link">
    <span class="md-ellipsis">
      to_plotly
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Line
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph" class="md-nav__link">
    <span class="md-ellipsis">
      MolGraph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MolGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.filter" class="md-nav__link">
    <span class="md-ellipsis">
      filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.formula" class="md-nav__link">
    <span class="md-ellipsis">
      formula
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.read_xyz" class="md-nav__link">
    <span class="md-ellipsis">
      read_xyz
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.set_default_color" class="md-nav__link">
    <span class="md-ellipsis">
      set_default_color
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.set_element_color" class="md-nav__link">
    <span class="md-ellipsis">
      set_element_color
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.set_element_radius" class="md-nav__link">
    <span class="md-ellipsis">
      set_element_radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.to_networkx" class="md-nav__link">
    <span class="md-ellipsis">
      to_networkx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xyz2graph.xyz2graph.MolGraph.to_plotly" class="md-nav__link">
    <span class="md-ellipsis">
      to_plotly
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="python-api">Python API</h1>


<div class="doc doc-object doc-class">



<h2 id="xyz2graph.xyz2graph.MolGraph" class="doc doc-heading">
            <code>xyz2graph.xyz2graph.MolGraph</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents first">


        <p>Represents a molecular graph structure.</p>
<p>This class provides functionality to read molecular structure data from XYZ files,
analyze molecular geometry, and visualize the molecular structure using Plotly.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.elements">elements</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of atomic elements in the molecule.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.x">x</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of x-coordinates for each atom.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.y">y</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of y-coordinates for each atom.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.z">z</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of z-coordinates for each atom.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.comment">comment</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional comment or title from the XYZ file.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.adj_list">adj_list</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[int, <span title="typing.Set">Set</span>[int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping atom indices to their
connected neighbors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.atomic_radii">atomic_radii</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of atomic radii for each atom.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.bond_lengths">bond_lengths</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="typing.FrozenSet">FrozenSet</span>[int], float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping pairs of
connected atoms to their bond lengths.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.adj_matrix">adj_matrix</span></code></td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.int_">int_</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array representing the adjacency
matrix of the molecular graph.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="xyz2graph.xyz2graph.MolGraph.indices">indices</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of original indices for each atom, preserved during filtering
operations. Maps current atoms back to their positions in the original structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span> <span class="o">=</span> <span class="n">MolGraph</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="s1">&#39;molecule.xyz&#39;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">formula</span><span class="p">())</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&#39;C2H6O&#39;</span>
</code></pre></div>






              <details class="quote">
                <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="nd">@dataclass</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="k">class</span> <span class="nc">MolGraph</span><span class="p">:</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a molecular graph structure.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    This class provides functionality to read molecular structure data from XYZ files,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    analyze molecular geometry, and visualize the molecular structure using Plotly.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        elements (List[str]): List of atomic elements in the molecule.</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        x (List[float]): List of x-coordinates for each atom.</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        y (List[float]): List of y-coordinates for each atom.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        z (List[float]): List of z-coordinates for each atom.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        comment (str): Optional comment or title from the XYZ file.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        adj_list (Dict[int, Set[int]]): Dictionary mapping atom indices to their</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            connected neighbors.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        atomic_radii (List[float]): List of atomic radii for each atom.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        bond_lengths (Dict[FrozenSet[int], float]): Dictionary mapping pairs of</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            connected atoms to their bond lengths.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        adj_matrix (NDArray[np.int_] | None): Numpy array representing the adjacency</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            matrix of the molecular graph.</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        indices (List[int]): List of original indices for each atom, preserved during filtering</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            operations. Maps current atoms back to their positions in the original structure.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        &gt;&gt;&gt; mg.read_xyz(&#39;molecule.xyz&#39;)</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        &gt;&gt;&gt; print(mg.formula())</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        &#39;C2H6O&#39;</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">elements</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>    <span class="n">x</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">y</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">z</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="n">adj_list</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="n">atomic_radii</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="n">bond_lengths</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">FrozenSet</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="n">adj_matrix</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">indices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="c1"># Customizable parameters with defaults</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="n">default_radii</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">DEFAULT_RADII</span><span class="p">))</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">cpk_colors</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">DEFAULT_CPK_COLORS</span><span class="p">))</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="n">cpk_color_rest</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;pink&quot;</span><span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="k">def</span> <span class="nf">set_element_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the reference radius for a specific element and update the adjacency list.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        Updates the reference radius for the specified chemical element</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        and recalculates the molecular adjacency list based on the new radius value.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">            element (str): Chemical element symbol</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            radius (float): New radius value in Angstroms</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            &gt;&gt;&gt; mg.set_element_radius(&#39;C&#39;, 0.75)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_radii</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default_radii</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generate_adjacency_list</span><span class="p">()</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="k">def</span> <span class="nf">set_element_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the CPK color for a specific element.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        Assigns a custom CPK (Corey-Pauling-Koltun) color to the specified chemical element</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        for use in molecular visualizations.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            element (str): Chemical element symbol</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            color (str): Color name or code (any format accepted by Plotly)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            &gt;&gt;&gt; mg.set_element_color(&#39;O&#39;, &#39;green&#39;)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            &gt;&gt;&gt; mg.set_element_color(&#39;C&#39;, &#39;#00FF00&#39;)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cpk_colors</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="k">def</span> <span class="nf">set_default_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the default color for elements not in the standard CPK color scheme.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        Specifies the fallback color to use for any chemical elements</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        that don&#39;t have a standard CPK color assignment.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            color (str): Color name or code (any format accepted by Plotly)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            &gt;&gt;&gt; mg.set_default_color(&#39;gray&#39;)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            &gt;&gt;&gt; mg.set_default_color(&#39;#A0A0A0&#39;)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cpk_color_rest</span> <span class="o">=</span> <span class="n">color</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">indices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">elements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;MolGraph&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter out atoms by indices and/or elements.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        Filter atoms from the molecular structure based on their indices or element types.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        Can either modify the existing structure or create a new filtered copy.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            indices (List[int], optional): List of atom indices to filter out.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">                If None, no indices are removed.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">            elements (List[str], optional): List of element symbols to filter out.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">                If None, no elements are removed.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">            inplace (bool, default=False): If True, modifies the current object.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">                If False, returns a new object.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">            Optional[MolGraph]: A new filtered MolGraph object if inplace=False,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">                None if inplace=True.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">            ValueError: If filtering would remove all atoms.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">            IndexError: If any index is out of range.</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">            &gt;&gt;&gt; mg_without_h = mg.filter(elements=[&#39;H&#39;]) # Filter out all hydrogen atoms</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">            &gt;&gt;&gt; mg_trimmed = mg.filter(indices=[0, 1, 2]) # Filter out specific atoms by index</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">            &gt;&gt;&gt; mg_modified = mg.filter(indices=[0, 1, 2], elements=[&#39;H&#39;])</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">            &gt;&gt;&gt; mg.filter(elements=[&#39;H&#39;], inplace=True) # Modify in place</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">compress</span><span class="p">,</span> <span class="n">starmap</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>        <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">and_</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>        <span class="c1"># Create mask for all atoms (True means keep)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="c1"># Apply indices filter if specified</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="c1"># Validate indices</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">):</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Atom index out of range&quot;</span><span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>                <span class="n">mask</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="c1"># Apply elements filter if specified</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="k">if</span> <span class="n">elements</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>            <span class="c1"># Track which filter elements are actually used</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="n">found_elements</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="k">if</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                    <span class="n">found_elements</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="c1"># Warn about unused filter elements</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="n">unused_elements</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">-</span> <span class="n">found_elements</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="k">if</span> <span class="n">unused_elements</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                    <span class="sa">f</span><span class="s2">&quot;Element(s) not found: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">unused_elements</span><span class="p">))</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                    <span class="s2">&quot;Use proper case (e.g., &#39;H&#39; not &#39;h&#39;)&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>                <span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="c1"># Update mask to remove specified elements</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">element_mask</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">elements</span> <span class="ow">or</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="n">mask</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">starmap</span><span class="p">(</span><span class="n">and_</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">element_mask</span><span class="p">)))</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>        <span class="c1"># Check if any atoms remain</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot filter out all atoms from molecule&quot;</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="c1"># If modifying in place</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="c1"># Store filtered data using compress</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>            <span class="c1"># Regenerate adjacency information</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generate_adjacency_list</span><span class="p">()</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="c1"># Create new instance</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>        <span class="n">new_mg</span> <span class="o">=</span> <span class="n">MolGraph</span><span class="p">()</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">atomic_radii</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="c1"># Copy customization settings</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">default_radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_radii</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">cpk_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpk_colors</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">cpk_color_rest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpk_color_rest</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="c1"># Generate adjacency information for new molecule</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="n">new_mg</span><span class="o">.</span><span class="n">_generate_adjacency_list</span><span class="p">()</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>        <span class="k">return</span> <span class="n">new_mg</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">def</span> <span class="nf">_parse_coordinates</span><span class="p">(</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse atomic coordinates from a coordinate string list.</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">        Takes a list of coordinate strings in &#39;element x y z&#39; format and parses them into</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">        separate lists of elements and their corresponding x, y, z coordinates. Each coordinate</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="sd">        string should contain an element symbol followed by three space-separated numeric values</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        representing the atomic position in 3D space.</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            data (Sequence[str]): List of coordinate strings, where each string contains an</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            element symbol and coordinates in the format &#39;element x y z&#39; (e.g., &#39;H 0.0 0.0 0.0&#39;).</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">            Tuple[List[str], List[float], List[float], List[float]]: A tuple containing four lists:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">            elements, x_coordinates, y_coordinates, and z_coordinates.</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">            ValueError: If any coordinate string has invalid format or contains unknown element</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">            symbols not present in the default radii dictionary.</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">            &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a><span class="sd">            &gt;&gt;&gt; coords = [&#39;H 0.0 0.0 0.0&#39;, &#39;O 0.0 0.0 1.0&#39;]</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a><span class="sd">            &gt;&gt;&gt; elements, x, y, z = mg._parse_coordinates(coords)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a><span class="sd">            &gt;&gt;&gt; print(elements)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a><span class="sd">            [&#39;H&#39;, &#39;O&#39;]</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a><span class="sd">            &gt;&gt;&gt; print(x)</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a><span class="sd">            [0.0, 0.0]</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="n">elements</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="sa">r</span><span class="s2">&quot;^([a-z]{1,3})\s+&quot;</span>  <span class="c1"># Element symbol (1-3 letters)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>            <span class="sa">r</span><span class="s2">&quot;(-?\d+\.?\d*)\s+&quot;</span>  <span class="c1"># x coordinate (integer or float)</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="sa">r</span><span class="s2">&quot;(-?\d+\.?\d*)\s+&quot;</span>  <span class="c1"># y coordinate (integer or float)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="sa">r</span><span class="s2">&quot;(-?\d+\.?\d*)$&quot;</span><span class="p">,</span>  <span class="c1"># z coordinate (integer or float)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">,</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>        <span class="p">)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">string</span> <span class="o">:=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()):</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                <span class="k">continue</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">match</span> <span class="o">:=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">string</span><span class="p">)):</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid coordinate format: </span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid coordinate format: </span><span class="si">{</span><span class="n">string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>            <span class="n">element</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="k">if</span> <span class="n">element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_radii</span><span class="p">:</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown element found: </span><span class="si">{</span><span class="n">element</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown element found: </span><span class="si">{</span><span class="n">element</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>            <span class="n">zs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;No valid coordinates found&quot;</span><span class="p">)</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No valid coordinates found&quot;</span><span class="p">)</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="k">return</span> <span class="n">elements</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="k">def</span> <span class="nf">read_xyz</span><span class="p">(</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">xyz_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads molecular structure data from an XYZ file.</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">        The file should have a header with the number of atoms and optional comment, followed by</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">        atomic coordinates in Angstroms with element symbols.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">            file_path (Union[str, Path]): Path to the XYZ file</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">            xyz_start (int, optional): Line number where XYZ coordinate data starts. Defaults to 2.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">            validate (bool, optional, default=False): If True, validates that the number</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">                of coordinates matches the atom count in the first line. Note: validation is</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">                automatically disabled if xyz_start=0. Defaults to False.</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">            FileNotFoundError: If the specified file does not exist</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">            ValueError: If the file format is invalid or contains unknown elements</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        Notes:</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">            The XYZ file format is a standard chemical file format that contains:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">                - First line: Number of atoms</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">                - Second line: Comment or molecule name (optional)</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">                - Remaining lines: Atomic coordinates in format &quot;element x y z&quot;</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">            The function supports both standard XYZ files (xyz_start=2) and raw coordinate data</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">            (xyz_start=0). When validation is enabled, it checks that the number of coordinates</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">            matches the atom count specified in the first line.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">            &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">            &gt;&gt;&gt; mg.read_xyz(&quot;molecule.xyz&quot;)  # Read standard XYZ file (starts at line 2)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">            &gt;&gt;&gt; mg.read_xyz(&quot;coords.xyz&quot;, xyz_start=0)  # Read XYZ data starting from first line</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">            &gt;&gt;&gt; mg.read_xyz(&quot;molecule.xyz&quot;, validate=True)  # Enable validation of atom count</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reading XYZ file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="c1"># Handle validation conflict</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="k">if</span> <span class="n">validate</span> <span class="ow">and</span> <span class="n">xyz_start</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>                <span class="s2">&quot;Atom count validation disabled:&quot;</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>                <span class="s2">&quot; cannot validate when reading from first line &quot;</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>                <span class="s2">&quot;(xyz_start=0)&quot;</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="n">validate</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZ file not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZ file not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>            <span class="n">lines</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">xyz_start</span><span class="p">:</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZ file has no coordinate data after line </span><span class="si">{</span><span class="n">xyz_start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZ file has no coordinate data after line </span><span class="si">{</span><span class="n">xyz_start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>            <span class="c1"># Get expected atom count if validation is requested</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>            <span class="n">expected_atoms</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>            <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                    <span class="n">expected_atoms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected number of atoms: </span><span class="si">{</span><span class="n">expected_atoms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Could not read atom count from first line&quot;</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not read atom count from first line&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>            <span class="c1"># Store comment if available (line 1 in standard XYZ format)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>            <span class="k">if</span> <span class="n">xyz_start</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read comment: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>            <span class="n">coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_coordinates</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">xyz_start</span><span class="p">:])</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">coordinates</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>            <span class="c1"># Validate number of atoms if requested</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>            <span class="k">if</span> <span class="n">validate</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span> <span class="o">!=</span> <span class="n">expected_atoms</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                    <span class="sa">f</span><span class="s2">&quot;Number of coordinates doesn&#39;t match atom count in first line. &quot;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>                    <span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected_atoms</span><span class="si">}</span><span class="s2">, Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>                <span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>                    <span class="sa">f</span><span class="s2">&quot;Number of coordinates doesn&#39;t match atom count in first line. &quot;</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>                    <span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected_atoms</span><span class="si">}</span><span class="s2">, Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>                <span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully read </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span><span class="si">}</span><span class="s2"> atoms from </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default_radii</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_generate_adjacency_list</span><span class="p">()</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>            <span class="c1"># Store only essential geometric and reference data</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_original_state</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>                <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>                <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>                <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>                <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>                <span class="s2">&quot;indices&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>            <span class="p">}</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading XYZ file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>            <span class="k">raise</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="k">def</span> <span class="nf">_create_atom_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_config</span><span class="p">:</span> <span class="n">PlotConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">:</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a Plotly trace for atoms in the molecule.&quot;&quot;&quot;</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cpk_colors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpk_color_rest</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="n">hover_text</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">elem</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">z</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="p">]</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>            <span class="n">z</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>                    <span class="n">color</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;atom_border_color&quot;</span><span class="p">],</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                    <span class="n">width</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;atom_border_width&quot;</span><span class="p">],</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>                <span class="p">),</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>                <span class="n">size</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;atom_size&quot;</span><span class="p">],</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>                <span class="n">opacity</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;atom_opacity&quot;</span><span class="p">],</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>                <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>            <span class="p">),</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>            <span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>            <span class="n">hovertext</span><span class="o">=</span><span class="n">hover_text</span><span class="p">,</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>            <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;atoms&quot;</span><span class="p">,</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="p">)</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>    <span class="k">def</span> <span class="nf">_create_bond_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_config</span><span class="p">:</span> <span class="n">PlotConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a Plotly trace for bonds in the molecule.&quot;&quot;&quot;</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="c1"># Create line segments for each bond (use None to separate segments)</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="n">xs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="n">ys</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>            <span class="n">zs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="kc">None</span><span class="p">])</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>        <span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>            <span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">,</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>            <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">,</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>            <span class="n">z</span><span class="o">=</span><span class="n">zs</span><span class="p">,</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;bond_color&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;bond_width&quot;</span><span class="p">]),</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>            <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bonds&quot;</span><span class="p">,</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>        <span class="p">)</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>    <span class="k">def</span> <span class="nf">_create_annotations</span><span class="p">(</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>        <span class="n">plot_config</span><span class="p">:</span> <span class="n">PlotConfig</span><span class="p">,</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>        <span class="n">atom_label_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>        <span class="n">show_distances</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create annotations for atom and bond labels in the molecular plot.</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a><span class="sd">        Creates Plotly annotation dictionaries for displaying atom labels (either element</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a><span class="sd">        symbols or indices) and/or bond length labels. The annotations are positioned above</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a><span class="sd">        each atom or bond with configurable vertical offset.</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a><span class="sd">            plot_config (PlotConfig): Plot configuration dictionary containing visual</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="sd">                parameters like label offsets and colors.</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="sd">            atom_label_type (Optional[str]): Type of atom labels to show. Must be one of:</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a><span class="sd">                None, &quot;element&quot;, or &quot;index&quot;. None means no atom labels.</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">            show_distances (bool): Whether to show bond length labels centered on each bond.</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">            List[dict]: List of Plotly annotation dictionaries containing text, position,</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">                and style information for atom and bond labels.</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">            ValueError: If atom_label_type is not one of: None, &quot;element&quot;, or &quot;index&quot;.</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>        <span class="k">if</span> <span class="n">atom_label_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="k">if</span> <span class="n">atom_label_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">):</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;atom_label_type must be None, &quot;element&quot;, or &quot;index&quot;&#39;</span><span class="p">)</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>                <span class="n">text</span> <span class="o">=</span> <span class="n">element</span> <span class="k">if</span> <span class="n">atom_label_type</span> <span class="o">==</span> <span class="s2">&quot;element&quot;</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                    <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                        <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>                        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>                        <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>                        <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>                        <span class="n">yshift</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;label_offset&quot;</span><span class="p">],</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>                    <span class="p">)</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>                <span class="p">)</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>        <span class="k">if</span> <span class="n">show_distances</span><span class="p">:</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>            <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">length</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_lengths</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>                    <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">length</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>                        <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>                        <span class="n">y</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>                        <span class="n">z</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                        <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>                        <span class="n">yshift</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;label_offset&quot;</span><span class="p">],</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                        <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;bond_label_color&quot;</span><span class="p">]),</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>                    <span class="p">)</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>                <span class="p">)</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>        <span class="k">return</span> <span class="n">labels</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a>    <span class="k">def</span> <span class="nf">_create_menu_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_config</span><span class="p">:</span> <span class="n">PlotConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates menu buttons for toggling different label displays.&quot;&quot;&quot;</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="k">return</span> <span class="p">[</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a>            <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Elements&quot;</span><span class="p">,</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;relayout&quot;</span><span class="p">,</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>                <span class="n">args</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>                    <span class="p">{</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>                        <span class="s2">&quot;scene.annotations&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_annotations</span><span class="p">(</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>                            <span class="n">plot_config</span><span class="p">,</span> <span class="n">atom_label_type</span><span class="o">=</span><span class="s2">&quot;element&quot;</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>                        <span class="p">)</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>                    <span class="p">}</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>                <span class="p">],</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>            <span class="p">),</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>            <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Elements &amp; Distances&quot;</span><span class="p">,</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;relayout&quot;</span><span class="p">,</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>                <span class="n">args</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>                    <span class="p">{</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>                        <span class="s2">&quot;scene.annotations&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_annotations</span><span class="p">(</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>                            <span class="n">plot_config</span><span class="p">,</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>                            <span class="n">atom_label_type</span><span class="o">=</span><span class="s2">&quot;element&quot;</span><span class="p">,</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>                            <span class="n">show_distances</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>                        <span class="p">)</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>                    <span class="p">}</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>                <span class="p">],</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>            <span class="p">),</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>            <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;IDs&quot;</span><span class="p">,</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;relayout&quot;</span><span class="p">,</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>                <span class="n">args</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>                    <span class="p">{</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>                        <span class="s2">&quot;scene.annotations&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_annotations</span><span class="p">(</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>                            <span class="n">plot_config</span><span class="p">,</span> <span class="n">atom_label_type</span><span class="o">=</span><span class="s2">&quot;index&quot;</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>                        <span class="p">)</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                    <span class="p">}</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>                <span class="p">],</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>            <span class="p">),</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>            <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;IDs &amp; Distances&quot;</span><span class="p">,</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;relayout&quot;</span><span class="p">,</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                <span class="n">args</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                    <span class="p">{</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>                        <span class="s2">&quot;scene.annotations&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_annotations</span><span class="p">(</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>                            <span class="n">plot_config</span><span class="p">,</span> <span class="n">atom_label_type</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">show_distances</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                        <span class="p">)</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>                    <span class="p">}</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                <span class="p">],</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>            <span class="p">),</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>            <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Distances&quot;</span><span class="p">,</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;relayout&quot;</span><span class="p">,</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                <span class="n">args</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>                    <span class="p">{</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>                        <span class="s2">&quot;scene.annotations&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_annotations</span><span class="p">(</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>                            <span class="n">plot_config</span><span class="p">,</span> <span class="n">show_distances</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                        <span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>                    <span class="p">}</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                <span class="p">],</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>            <span class="p">),</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>            <span class="nb">dict</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Clear&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;relayout&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[{</span><span class="s2">&quot;scene.annotations&quot;</span><span class="p">:</span> <span class="p">[]}]),</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>        <span class="p">]</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>    <span class="k">def</span> <span class="nf">to_plotly</span><span class="p">(</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>        <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PlotConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>        <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates an interactive 3D visualization of the molecular structure.</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">        Generates a Plotly figure displaying atoms as spheres and bonds as lines, with</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">        configurable visual properties and interactive features for exploring the molecule&#39;s</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="sd">        geometry.</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">            config (Optional[PlotConfig]): Dictionary of visualization settings:</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">                - atom_size (int): Size of atom markers (default: 7)</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">                - atom_opacity (float): Opacity of atoms from 0.0-1.0 (default: 0.8)</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">                - atom_border_color (str): Color of atom borders (default: &quot;lightgray&quot;)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">                - atom_border_width (int): Width of atom borders (default: 2)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">                - bond_color (str): Color of bonds between atoms (default: &quot;grey&quot;)</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">                - bond_width (int): Width of bond lines (default: 2)</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">                - show_grid (bool): Whether to display axis grid (default: False)</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">                - label_offset (int): Vertical offset for labels (default: 15)</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">                - bond_label_color (str): Color of bond length labels (default: &quot;steelblue&quot;)</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">            title (Optional[str]): Title displayed above visualization (default: None)</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">            go.Figure: Plotly figure object containing:</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">                - 3D scatter plot of atoms colored by element</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">                - Line segments representing bonds</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">                - Interactive menu for toggling labels:</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">                    - Element symbols</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">                    - Atom indices</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">                    - Bond lengths</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">                    - Combinations of the above</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">                - Mouse controls for rotation, zoom, and pan</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">            &gt;&gt;&gt; fig = mg.to_plotly(config={</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">            ...     &quot;atom_size&quot;: 12,</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">            ...     &quot;atom_opacity&quot;: 0.9,</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">            ...     &quot;bond_color&quot;: &quot;black&quot;,</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">            ...     &quot;show_grid&quot;: True,</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">            ...     &quot;label_offset&quot;: 20</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">            ... })</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">            &gt;&gt;&gt; fig.show()</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating Plotly figure&quot;</span><span class="p">)</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No molecular data to visualize&quot;</span><span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>            <span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>        <span class="n">plot_config</span> <span class="o">=</span> <span class="n">DEFAULT_PLOT_CONFIG</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>        <span class="k">if</span> <span class="n">config</span><span class="p">:</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>            <span class="n">plot_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>        <span class="c1"># Create figure</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_create_atom_trace</span><span class="p">(</span><span class="n">plot_config</span><span class="p">),</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_create_bond_trace</span><span class="p">(</span><span class="n">plot_config</span><span class="p">),</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>        <span class="p">]</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>        <span class="c1"># Configure axis parameters</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>        <span class="n">axis_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>            <span class="n">showgrid</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;show_grid&quot;</span><span class="p">],</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>            <span class="n">showbackground</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>            <span class="n">showticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>            <span class="n">zeroline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>            <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>            <span class="n">showspikes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="p">)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>        <span class="c1"># Build layout</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="n">layout</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>            <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>                <span class="n">xaxis</span><span class="o">=</span><span class="n">axis_params</span><span class="p">,</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>                <span class="n">yaxis</span><span class="o">=</span><span class="n">axis_params</span><span class="p">,</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>                <span class="n">zaxis</span><span class="o">=</span><span class="n">axis_params</span><span class="p">,</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>                <span class="n">annotations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_annotations</span><span class="p">(</span><span class="n">plot_config</span><span class="p">,</span> <span class="n">atom_label_type</span><span class="o">=</span><span class="s2">&quot;element&quot;</span><span class="p">),</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>            <span class="p">),</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>            <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="k">else</span> <span class="mi">40</span><span class="p">),</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>            <span class="n">updatemenus</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>                <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>                    <span class="n">buttons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_menu_buttons</span><span class="p">(</span><span class="n">plot_config</span><span class="p">),</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>                    <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;down&quot;</span><span class="p">,</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>                    <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                    <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                    <span class="n">pad</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                <span class="p">)</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>            <span class="p">],</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>        <span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plotly figure created successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>        <span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>    <span class="k">def</span> <span class="nf">to_networkx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the current graph representation to a NetworkX graph.</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">        Creates a NetworkX graph from the stored adjacency list, adding node and edge attributes.</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">        Node attributes include the chemical element and xyz coordinates, while edge attributes</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">        store bond lengths.</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">            nx.Graph: NetworkX graph containing molecular structure with node attributes &#39;element&#39;</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">                and &#39;xyz&#39; (coordinates), and edge attribute &#39;length&#39; (bond length).</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">            &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">            &gt;&gt;&gt; mg.read_xyz(&#39;molecule.xyz&#39;)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">            &gt;&gt;&gt; G = mg.to_networkx()</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">            &gt;&gt;&gt; print(G.nodes[0][&#39;element&#39;])</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">            &#39;C&#39;</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">            &gt;&gt;&gt; print(G.edges[(0, 1)][&#39;length&#39;])</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">            1.54</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating NetworkX graph&quot;</span><span class="p">)</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adj_list</span><span class="p">)</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>        <span class="c1"># Add node attributes</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="n">node_attrs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>            <span class="n">num</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">element</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">num</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">num</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">num</span><span class="p">])}</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>            <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>        <span class="p">}</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>        <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">node_attrs</span><span class="p">)</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>        <span class="c1"># Add edge attributes</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>        <span class="n">edge_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="n">edge</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="n">length</span><span class="p">}</span> <span class="k">for</span> <span class="n">edge</span><span class="p">,</span> <span class="n">length</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_lengths</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>        <span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">edge_attrs</span><span class="p">)</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;NetworkX graph created successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>        <span class="k">return</span> <span class="n">G</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="k">def</span> <span class="nf">_generate_adjacency_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates the adjacency list and matrix based on atomic positions and radii.</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">        This method uses atomic positions and reference radii to determine bonding</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">        between atoms. Two atoms are considered bonded if their distance is less</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a><span class="sd">        than 1.3 times the sum of their atomic radii.</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Generating adjacency list&quot;</span><span class="p">)</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>            <span class="n">xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>            <span class="n">distances</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">xyz</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>            <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijk,ijk-&gt;ij&quot;</span><span class="p">,</span> <span class="n">distances</span><span class="p">,</span> <span class="n">distances</span><span class="p">))</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>            <span class="n">atomic_radii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span><span class="p">)</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>            <span class="n">distance_bond</span> <span class="o">=</span> <span class="p">(</span><span class="n">atomic_radii</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">+</span> <span class="n">atomic_radii</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.3</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">adj_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">&lt;</span> <span class="n">distances</span><span class="p">,</span> <span class="n">distance_bond</span> <span class="o">&gt;</span> <span class="n">distances</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>            <span class="c1"># Clear existing adjacency data</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">adj_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bond_lengths</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>            <span class="c1"># Generate new adjacency data</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adj_matrix</span><span class="p">)):</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">adj_list</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">adj_list</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">bond_lengths</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Adjacency list generated successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error generating adjacency list: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>            <span class="k">raise</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an iterator yielding all bonds in the molecular graph.</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">        Iterates through the adjacency list to generate all unique pairs of bonded atoms</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">        in the structure, ensuring each bond is only yielded once.</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">            tuple[int, int]: A pair of atom indices representing a bonded atomic pair,</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">                where each index corresponds to the atom&#39;s position in the molecular structure.</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">            &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">            &gt;&gt;&gt; mg.read_xyz(&#39;molecule.xyz&#39;)</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">            &gt;&gt;&gt; for atom1, atom2 in mg.edges():</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">            ...     print(f&quot;Bond between atoms {atom1} and {atom2}&quot;)</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">            Bond between atoms 0 and 1</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">            Bond between atoms 1 and 2</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>        <span class="n">edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">neighbours</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adj_list</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>            <span class="k">for</span> <span class="n">neighbour</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>                <span class="n">bond</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">node</span><span class="p">,</span> <span class="n">neighbour</span><span class="p">])</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>                <span class="k">if</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>                <span class="n">edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>                <span class="k">yield</span> <span class="n">node</span><span class="p">,</span> <span class="n">neighbour</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>    <span class="k">def</span> <span class="nf">formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the molecular formula of the structure in Hill notation.</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">        Generates a string representation of the molecular formula following Hill</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">        notation conventions, where carbon and hydrogen (if present) are listed first,</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        followed by other elements in alphabetical order. Numbers are added as</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">        subscripts for elements appearing multiple times.</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">            str: The molecular formula string with elements ordered by Hill notation</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">                (e.g., &#39;C2H6O&#39; for ethanol).</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        Examples:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">            &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">            &gt;&gt;&gt; mg.read_xyz(&#39;ethanol.xyz&#39;)</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">            &gt;&gt;&gt; print(mg.formula())</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">            &#39;C2H6O&#39;</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>        <span class="n">element_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>        <span class="c1"># Build formula in Hill notation</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>        <span class="n">formula_parts</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>        <span class="c1"># Carbon and Hydrogen first if carbon is present</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>        <span class="k">if</span> <span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">element_counts</span><span class="p">:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>            <span class="n">count</span> <span class="o">=</span> <span class="n">element_counts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>            <span class="n">formula_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">count</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>            <span class="k">if</span> <span class="s2">&quot;H&quot;</span> <span class="ow">in</span> <span class="n">element_counts</span><span class="p">:</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>                <span class="n">count</span> <span class="o">=</span> <span class="n">element_counts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>                <span class="n">formula_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;H</span><span class="si">{</span><span class="n">count</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>        <span class="c1"># Add remaining elements alphabetically</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">element_counts</span><span class="p">):</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>            <span class="n">count</span> <span class="o">=</span> <span class="n">element_counts</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>            <span class="n">formula_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">element</span><span class="si">}{</span><span class="n">count</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formula_parts</span><span class="p">)</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of atoms in the molecule.</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">            int: Number of atoms</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the element and coordinates for the atom at the given position.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">            position: Index of the atom</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">            Tuple[str, Tuple[float, float, float]]: Tuple containing the element</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">            symbol and its (x, y, z) coordinates</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a><span class="sd">            IndexError: If position is out of range</span>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">position</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Atom index out of range&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">position</span><span class="p">],</span> <span class="p">(</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">position</span><span class="p">],</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">position</span><span class="p">],</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">position</span><span class="p">],</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a>        <span class="p">)</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]:</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates an iterator over all atoms in the molecule.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">            Iterator[Tuple[str, Tuple[float, float, float]]]: Iterator yielding</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">            tuples of (element, coordinates) for each atom</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a simplified string representation of the molecular graph.</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">            str: A string showing molecular formula and basic structural information</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a>            <span class="k">return</span> <span class="s2">&quot;MolGraph(empty)&quot;</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a>        <span class="n">element_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a>        <span class="c1"># Build formula prioritizing C and H</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a>        <span class="n">formula_parts</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>            <span class="k">if</span> <span class="n">count</span> <span class="o">:=</span> <span class="n">element_counts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a>                <span class="n">formula_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">element</span><span class="si">}{</span><span class="n">count</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a>        <span class="c1"># Add remaining elements alphabetically</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">element_counts</span><span class="p">):</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a>            <span class="n">count</span> <span class="o">=</span> <span class="n">element_counts</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a>            <span class="n">formula_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">element</span><span class="si">}{</span><span class="n">count</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a>        <span class="n">formula</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formula_parts</span><span class="p">)</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a>        <span class="n">num_bonds</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">neighbors</span><span class="p">)</span> <span class="k">for</span> <span class="n">neighbors</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adj_list</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">//</span> <span class="mi">2</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MolGraph(</span><span class="si">{</span><span class="n">formula</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span><span class="si">}</span><span class="s2"> atoms, </span><span class="si">{</span><span class="n">num_bonds</span><span class="si">}</span><span class="s2"> bonds)&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="xyz2graph.xyz2graph.MolGraph.edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edges</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create an iterator yielding all bonds in the molecular graph.</p>
<p>Iterates through the adjacency list to generate all unique pairs of bonded atoms
in the structure, ensuring each bond is only yielded once.</p>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[int, int]: A pair of atom indices representing a bonded atomic pair,
where each index corresponds to the atom's position in the molecular structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span> <span class="o">=</span> <span class="n">MolGraph</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="s1">&#39;molecule.xyz&#39;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">atom1</span><span class="p">,</span> <span class="n">atom2</span> <span class="ow">in</span> <span class="n">mg</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bond between atoms </span><span class="si">{</span><span class="n">atom1</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">atom2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">Bond between atoms 0 and 1</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">Bond between atoms 1 and 2</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an iterator yielding all bonds in the molecular graph.</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">    Iterates through the adjacency list to generate all unique pairs of bonded atoms</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">    in the structure, ensuring each bond is only yielded once.</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a><span class="sd">        tuple[int, int]: A pair of atom indices representing a bonded atomic pair,</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a><span class="sd">            where each index corresponds to the atom&#39;s position in the molecular structure.</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a><span class="sd">        &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a><span class="sd">        &gt;&gt;&gt; mg.read_xyz(&#39;molecule.xyz&#39;)</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a><span class="sd">        &gt;&gt;&gt; for atom1, atom2 in mg.edges():</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a><span class="sd">        ...     print(f&quot;Bond between atoms {atom1} and {atom2}&quot;)</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a><span class="sd">        Bond between atoms 0 and 1</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a><span class="sd">        Bond between atoms 1 and 2</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>    <span class="n">edges</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>    <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">neighbours</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adj_list</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>        <span class="k">for</span> <span class="n">neighbour</span> <span class="ow">in</span> <span class="n">neighbours</span><span class="p">:</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>            <span class="n">bond</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="n">node</span><span class="p">,</span> <span class="n">neighbour</span><span class="p">])</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>            <span class="k">if</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">edges</span><span class="p">:</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                <span class="k">continue</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>            <span class="n">edges</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>            <span class="k">yield</span> <span class="n">node</span><span class="p">,</span> <span class="n">neighbour</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="xyz2graph.xyz2graph.MolGraph.filter" class="doc doc-heading">
            <code class="highlight language-python"><span class="nb">filter</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Filter out atoms by indices and/or elements.</p>
<p>Filter atoms from the molecular structure based on their indices or element types.
Can either modify the existing structure or create a new filtered copy.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>indices</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of atom indices to filter out.
If None, no indices are removed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>elements</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of element symbols to filter out.
If None, no elements are removed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inplace</code>
            </td>
            <td>
                  <code>bool, default=False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, modifies the current object.
If False, returns a new object.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="xyz2graph.xyz2graph.MolGraph" href="#xyz2graph.xyz2graph.MolGraph">MolGraph</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[MolGraph]: A new filtered MolGraph object if inplace=False,
None if inplace=True.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If filtering would remove all atoms.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>IndexError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any index is out of range.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg_without_h</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">])</span> <span class="c1"># Filter out all hydrogen atoms</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg_trimmed</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="c1"># Filter out specific atoms by index</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg_modified</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">])</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Modify in place</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="k">def</span> <span class="nf">filter</span><span class="p">(</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="n">indices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">elements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;MolGraph&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter out atoms by indices and/or elements.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    Filter atoms from the molecular structure based on their indices or element types.</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    Can either modify the existing structure or create a new filtered copy.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        indices (List[int], optional): List of atom indices to filter out.</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">            If None, no indices are removed.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        elements (List[str], optional): List of element symbols to filter out.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            If None, no elements are removed.</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        inplace (bool, default=False): If True, modifies the current object.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">            If False, returns a new object.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        Optional[MolGraph]: A new filtered MolGraph object if inplace=False,</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">            None if inplace=True.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        ValueError: If filtering would remove all atoms.</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        IndexError: If any index is out of range.</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        &gt;&gt;&gt; mg_without_h = mg.filter(elements=[&#39;H&#39;]) # Filter out all hydrogen atoms</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        &gt;&gt;&gt; mg_trimmed = mg.filter(indices=[0, 1, 2]) # Filter out specific atoms by index</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        &gt;&gt;&gt; mg_modified = mg.filter(indices=[0, 1, 2], elements=[&#39;H&#39;])</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        &gt;&gt;&gt; mg.filter(elements=[&#39;H&#39;], inplace=True) # Modify in place</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">compress</span><span class="p">,</span> <span class="n">starmap</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>    <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">and_</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>    <span class="c1"># Create mask for all atoms (True means keep)</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="c1"># Apply indices filter if specified</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="c1"># Validate indices</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">):</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Atom index out of range&quot;</span><span class="p">)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>            <span class="n">mask</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="c1"># Apply elements filter if specified</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="k">if</span> <span class="n">elements</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="c1"># Track which filter elements are actually used</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="n">found_elements</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="k">if</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                <span class="n">found_elements</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="c1"># Warn about unused filter elements</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>        <span class="n">unused_elements</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">-</span> <span class="n">found_elements</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="k">if</span> <span class="n">unused_elements</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>                <span class="sa">f</span><span class="s2">&quot;Element(s) not found: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">unused_elements</span><span class="p">))</span><span class="si">}</span><span class="s2">. &quot;</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>                <span class="s2">&quot;Use proper case (e.g., &#39;H&#39; not &#39;h&#39;)&quot;</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>    <span class="c1"># Update mask to remove specified elements</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="n">element_mask</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">elements</span> <span class="ow">or</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>    <span class="n">mask</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">starmap</span><span class="p">(</span><span class="n">and_</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">element_mask</span><span class="p">)))</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="c1"># Check if any atoms remain</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot filter out all atoms from molecule&quot;</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="c1"># If modifying in place</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="c1"># Store filtered data using compress</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="c1"># Regenerate adjacency information</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_adjacency_list</span><span class="p">()</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>    <span class="c1"># Create new instance</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>    <span class="n">new_mg</span> <span class="o">=</span> <span class="n">MolGraph</span><span class="p">()</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">atomic_radii</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">mask</span><span class="p">))</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="c1"># Copy customization settings</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">default_radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_radii</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">cpk_colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpk_colors</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">cpk_color_rest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpk_color_rest</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>    <span class="c1"># Generate adjacency information for new molecule</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>    <span class="n">new_mg</span><span class="o">.</span><span class="n">_generate_adjacency_list</span><span class="p">()</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>    <span class="k">return</span> <span class="n">new_mg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="xyz2graph.xyz2graph.MolGraph.formula" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">formula</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the molecular formula of the structure in Hill notation.</p>
<p>Generates a string representation of the molecular formula following Hill
notation conventions, where carbon and hydrogen (if present) are listed first,
followed by other elements in alphabetical order. Numbers are added as
subscripts for elements appearing multiple times.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The molecular formula string with elements ordered by Hill notation
(e.g., 'C2H6O' for ethanol).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span> <span class="o">=</span> <span class="n">MolGraph</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="s1">&#39;ethanol.xyz&#39;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">formula</span><span class="p">())</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">&#39;C2H6O&#39;</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="k">def</span> <span class="nf">formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the molecular formula of the structure in Hill notation.</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">    Generates a string representation of the molecular formula following Hill</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">    notation conventions, where carbon and hydrogen (if present) are listed first,</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">    followed by other elements in alphabetical order. Numbers are added as</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a><span class="sd">    subscripts for elements appearing multiple times.</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">        str: The molecular formula string with elements ordered by Hill notation</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">            (e.g., &#39;C2H6O&#39; for ethanol).</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">        &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        &gt;&gt;&gt; mg.read_xyz(&#39;ethanol.xyz&#39;)</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">        &gt;&gt;&gt; print(mg.formula())</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        &#39;C2H6O&#39;</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a>    <span class="n">element_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a>    <span class="c1"># Build formula in Hill notation</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a>    <span class="n">formula_parts</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a>    <span class="c1"># Carbon and Hydrogen first if carbon is present</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a>    <span class="k">if</span> <span class="s2">&quot;C&quot;</span> <span class="ow">in</span> <span class="n">element_counts</span><span class="p">:</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a>        <span class="n">count</span> <span class="o">=</span> <span class="n">element_counts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>        <span class="n">formula_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">count</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a>        <span class="k">if</span> <span class="s2">&quot;H&quot;</span> <span class="ow">in</span> <span class="n">element_counts</span><span class="p">:</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a>            <span class="n">count</span> <span class="o">=</span> <span class="n">element_counts</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a>            <span class="n">formula_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;H</span><span class="si">{</span><span class="n">count</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a>    <span class="c1"># Add remaining elements alphabetically</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a>    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">element_counts</span><span class="p">):</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a>        <span class="n">count</span> <span class="o">=</span> <span class="n">element_counts</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a>        <span class="n">formula_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">element</span><span class="si">}{</span><span class="n">count</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a>    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formula_parts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="xyz2graph.xyz2graph.MolGraph.read_xyz" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_xyz</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">xyz_start</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Reads molecular structure data from an XYZ file.</p>
<p>The file should have a header with the number of atoms and optional comment, followed by
atomic coordinates in Angstroms with element symbols.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[str, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the XYZ file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xyz_start</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line number where XYZ coordinate data starts. Defaults to 2.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate</code>
            </td>
            <td>
                  <code>bool, optional, default=False</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, validates that the number
of coordinates matches the atom count in the first line. Note: validation is
automatically disabled if xyz_start=0. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>FileNotFoundError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the specified file does not exist</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file format is invalid or contains unknown elements</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>The XYZ file format is a standard chemical file format that contains:</p>
<div class="highlight"><pre><span></span><code>- First line: Number of atoms
- Second line: Comment or molecule name (optional)
- Remaining lines: Atomic coordinates in format &quot;element x y z&quot;
</code></pre></div>
<p>The function supports both standard XYZ files (xyz_start=2) and raw coordinate data
(xyz_start=0). When validation is enabled, it checks that the number of coordinates
matches the atom count specified in the first line.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span> <span class="o">=</span> <span class="n">MolGraph</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="s2">&quot;molecule.xyz&quot;</span><span class="p">)</span>  <span class="c1"># Read standard XYZ file (starts at line 2)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="s2">&quot;coords.xyz&quot;</span><span class="p">,</span> <span class="n">xyz_start</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Read XYZ data starting from first line</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="s2">&quot;molecule.xyz&quot;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Enable validation of atom count</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="k">def</span> <span class="nf">read_xyz</span><span class="p">(</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">xyz_start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads molecular structure data from an XYZ file.</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">    The file should have a header with the number of atoms and optional comment, followed by</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">    atomic coordinates in Angstroms with element symbols.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        file_path (Union[str, Path]): Path to the XYZ file</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        xyz_start (int, optional): Line number where XYZ coordinate data starts. Defaults to 2.</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">        validate (bool, optional, default=False): If True, validates that the number</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">            of coordinates matches the atom count in the first line. Note: validation is</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">            automatically disabled if xyz_start=0. Defaults to False.</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        FileNotFoundError: If the specified file does not exist</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        ValueError: If the file format is invalid or contains unknown elements</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">    Notes:</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        The XYZ file format is a standard chemical file format that contains:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">            - First line: Number of atoms</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">            - Second line: Comment or molecule name (optional)</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">            - Remaining lines: Atomic coordinates in format &quot;element x y z&quot;</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        The function supports both standard XYZ files (xyz_start=2) and raw coordinate data</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        (xyz_start=0). When validation is enabled, it checks that the number of coordinates</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        matches the atom count specified in the first line.</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        &gt;&gt;&gt; mg.read_xyz(&quot;molecule.xyz&quot;)  # Read standard XYZ file (starts at line 2)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a><span class="sd">        &gt;&gt;&gt; mg.read_xyz(&quot;coords.xyz&quot;, xyz_start=0)  # Read XYZ data starting from first line</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">        &gt;&gt;&gt; mg.read_xyz(&quot;molecule.xyz&quot;, validate=True)  # Enable validation of atom count</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reading XYZ file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="c1"># Handle validation conflict</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="k">if</span> <span class="n">validate</span> <span class="ow">and</span> <span class="n">xyz_start</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>            <span class="s2">&quot;Atom count validation disabled:&quot;</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>            <span class="s2">&quot; cannot validate when reading from first line &quot;</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>            <span class="s2">&quot;(xyz_start=0)&quot;</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="p">)</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="n">validate</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZ file not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZ file not found: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">xyz_start</span><span class="p">:</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZ file has no coordinate data after line </span><span class="si">{</span><span class="n">xyz_start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XYZ file has no coordinate data after line </span><span class="si">{</span><span class="n">xyz_start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="c1"># Get expected atom count if validation is requested</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">expected_atoms</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>                <span class="n">expected_atoms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected number of atoms: </span><span class="si">{</span><span class="n">expected_atoms</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Could not read atom count from first line&quot;</span><span class="p">)</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not read atom count from first line&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>        <span class="c1"># Store comment if available (line 1 in standard XYZ format)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>        <span class="k">if</span> <span class="n">xyz_start</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read comment: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">comment</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="n">coordinates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_coordinates</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">xyz_start</span><span class="p">:])</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">coordinates</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="c1"># Validate number of atoms if requested</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="k">if</span> <span class="n">validate</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span> <span class="o">!=</span> <span class="n">expected_atoms</span><span class="p">:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                <span class="sa">f</span><span class="s2">&quot;Number of coordinates doesn&#39;t match atom count in first line. &quot;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>                <span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected_atoms</span><span class="si">}</span><span class="s2">, Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>            <span class="p">)</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>                <span class="sa">f</span><span class="s2">&quot;Number of coordinates doesn&#39;t match atom count in first line. &quot;</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>                <span class="sa">f</span><span class="s2">&quot;Expected: </span><span class="si">{</span><span class="n">expected_atoms</span><span class="si">}</span><span class="s2">, Found: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>            <span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully read </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span><span class="si">}</span><span class="s2"> atoms from </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default_radii</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_adjacency_list</span><span class="p">()</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="c1"># Store only essential geometric and reference data</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_original_state</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>            <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>            <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="s2">&quot;indices&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>        <span class="p">}</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading XYZ file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="xyz2graph.xyz2graph.MolGraph.set_default_color" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_default_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the default color for elements not in the standard CPK color scheme.</p>
<p>Specifies the fallback color to use for any chemical elements
that don't have a standard CPK color assignment.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color name or code (any format accepted by Plotly)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">set_default_color</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">set_default_color</span><span class="p">(</span><span class="s1">&#39;#A0A0A0&#39;</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="k">def</span> <span class="nf">set_default_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the default color for elements not in the standard CPK color scheme.</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    Specifies the fallback color to use for any chemical elements</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    that don&#39;t have a standard CPK color assignment.</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        color (str): Color name or code (any format accepted by Plotly)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        &gt;&gt;&gt; mg.set_default_color(&#39;gray&#39;)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        &gt;&gt;&gt; mg.set_default_color(&#39;#A0A0A0&#39;)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cpk_color_rest</span> <span class="o">=</span> <span class="n">color</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="xyz2graph.xyz2graph.MolGraph.set_element_color" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_element_color</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the CPK color for a specific element.</p>
<p>Assigns a custom CPK (Corey-Pauling-Koltun) color to the specified chemical element
for use in molecular visualizations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>element</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Chemical element symbol</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color name or code (any format accepted by Plotly)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">set_element_color</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">set_element_color</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;#00FF00&#39;</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="k">def</span> <span class="nf">set_element_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the CPK color for a specific element.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    Assigns a custom CPK (Corey-Pauling-Koltun) color to the specified chemical element</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">    for use in molecular visualizations.</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        element (str): Chemical element symbol</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        color (str): Color name or code (any format accepted by Plotly)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        &gt;&gt;&gt; mg.set_element_color(&#39;O&#39;, &#39;green&#39;)</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        &gt;&gt;&gt; mg.set_element_color(&#39;C&#39;, &#39;#00FF00&#39;)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">cpk_colors</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="xyz2graph.xyz2graph.MolGraph.set_element_radius" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_element_radius</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set the reference radius for a specific element and update the adjacency list.</p>
<p>Updates the reference radius for the specified chemical element
and recalculates the molecular adjacency list based on the new radius value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>element</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Chemical element symbol</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New radius value in Angstroms</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">set_element_radius</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="k">def</span> <span class="nf">set_element_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the reference radius for a specific element and update the adjacency list.</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    Updates the reference radius for the specified chemical element</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    and recalculates the molecular adjacency list based on the new radius value.</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        element (str): Chemical element symbol</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        radius (float): New radius value in Angstroms</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        &gt;&gt;&gt; mg.set_element_radius(&#39;C&#39;, 0.75)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">default_radii</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atomic_radii</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default_radii</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_adjacency_list</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="xyz2graph.xyz2graph.MolGraph.to_networkx" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_networkx</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert the current graph representation to a NetworkX graph.</p>
<p>Creates a NetworkX graph from the stored adjacency list, adding node and edge attributes.
Node attributes include the chemical element and xyz coordinates, while edge attributes
store bond lengths.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="networkx.Graph">Graph</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>nx.Graph: NetworkX graph containing molecular structure with node attributes 'element'
and 'xyz' (coordinates), and edge attribute 'length' (bond length).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span> <span class="o">=</span> <span class="n">MolGraph</span><span class="p">()</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">mg</span><span class="o">.</span><span class="n">read_xyz</span><span class="p">(</span><span class="s1">&#39;molecule.xyz&#39;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">to_networkx</span><span class="p">()</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;element&#39;</span><span class="p">])</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">&#39;C&#39;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)][</span><span class="s1">&#39;length&#39;</span><span class="p">])</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go">1.54</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-874" name="__codelineno-0-874"></a><span class="k">def</span> <span class="nf">to_networkx</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">:</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert the current graph representation to a NetworkX graph.</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a><span class="sd">    Creates a NetworkX graph from the stored adjacency list, adding node and edge attributes.</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a><span class="sd">    Node attributes include the chemical element and xyz coordinates, while edge attributes</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a><span class="sd">    store bond lengths.</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="sd">        nx.Graph: NetworkX graph containing molecular structure with node attributes &#39;element&#39;</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a><span class="sd">            and &#39;xyz&#39; (coordinates), and edge attribute &#39;length&#39; (bond length).</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">        &gt;&gt;&gt; mg = MolGraph()</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">        &gt;&gt;&gt; mg.read_xyz(&#39;molecule.xyz&#39;)</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">        &gt;&gt;&gt; G = mg.to_networkx()</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">        &gt;&gt;&gt; print(G.nodes[0][&#39;element&#39;])</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">        &#39;C&#39;</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">        &gt;&gt;&gt; print(G.edges[(0, 1)][&#39;length&#39;])</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a><span class="sd">        1.54</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating NetworkX graph&quot;</span><span class="p">)</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adj_list</span><span class="p">)</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>    <span class="c1"># Add node attributes</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>    <span class="n">node_attrs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="n">num</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="n">element</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">num</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">num</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="n">num</span><span class="p">])}</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>    <span class="p">}</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">node_attrs</span><span class="p">)</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>    <span class="c1"># Add edge attributes</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>    <span class="n">edge_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="n">edge</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="n">length</span><span class="p">}</span> <span class="k">for</span> <span class="n">edge</span><span class="p">,</span> <span class="n">length</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_lengths</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>    <span class="n">nx</span><span class="o">.</span><span class="n">set_edge_attributes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">edge_attrs</span><span class="p">)</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;NetworkX graph created successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>    <span class="k">return</span> <span class="n">G</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="xyz2graph.xyz2graph.MolGraph.to_plotly" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_plotly</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creates an interactive 3D visualization of the molecular structure.</p>
<p>Generates a Plotly figure displaying atoms as spheres and bonds as lines, with
configurable visual properties and interactive features for exploring the molecule's
geometry.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="xyz2graph.xyz2graph.PlotConfig">PlotConfig</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of visualization settings:</p>
<ul>
<li>atom_size (int): Size of atom markers (default: 7)</li>
<li>atom_opacity (float): Opacity of atoms from 0.0-1.0 (default: 0.8)</li>
<li>atom_border_color (str): Color of atom borders (default: "lightgray")</li>
<li>atom_border_width (int): Width of atom borders (default: 2)</li>
<li>bond_color (str): Color of bonds between atoms (default: "grey")</li>
<li>bond_width (int): Width of bond lines (default: 2)</li>
<li>show_grid (bool): Whether to display axis grid (default: False)</li>
<li>label_offset (int): Vertical offset for labels (default: 15)</li>
<li>bond_label_color (str): Color of bond length labels (default: "steelblue")</li>
</ul>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title displayed above visualization (default: None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objs.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>go.Figure: Plotly figure object containing:</p>
<ul>
<li>3D scatter plot of atoms colored by element</li>
<li>Line segments representing bonds</li>
<li>
<p>Interactive menu for toggling labels:</p>
<ul>
<li>Element symbols</li>
<li>Atom indices</li>
<li>Bond lengths</li>
<li>Combinations of the above</li>
</ul>
</li>
<li>
<p>Mouse controls for rotation, zoom, and pan</p>
</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">mg</span><span class="o">.</span><span class="n">to_plotly</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="s2">&quot;atom_size&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="s2">&quot;atom_opacity&quot;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="s2">&quot;bond_color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="s2">&quot;show_grid&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="s2">&quot;label_offset&quot;</span><span class="p">:</span> <span class="mi">20</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">})</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>xyz2graph/xyz2graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="k">def</span> <span class="nf">to_plotly</span><span class="p">(</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>    <span class="n">config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PlotConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>    <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an interactive 3D visualization of the molecular structure.</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">    Generates a Plotly figure displaying atoms as spheres and bonds as lines, with</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a><span class="sd">    configurable visual properties and interactive features for exploring the molecule&#39;s</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="sd">    geometry.</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">        config (Optional[PlotConfig]): Dictionary of visualization settings:</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="sd">            - atom_size (int): Size of atom markers (default: 7)</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a><span class="sd">            - atom_opacity (float): Opacity of atoms from 0.0-1.0 (default: 0.8)</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">            - atom_border_color (str): Color of atom borders (default: &quot;lightgray&quot;)</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a><span class="sd">            - atom_border_width (int): Width of atom borders (default: 2)</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">            - bond_color (str): Color of bonds between atoms (default: &quot;grey&quot;)</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">            - bond_width (int): Width of bond lines (default: 2)</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">            - show_grid (bool): Whether to display axis grid (default: False)</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">            - label_offset (int): Vertical offset for labels (default: 15)</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">            - bond_label_color (str): Color of bond length labels (default: &quot;steelblue&quot;)</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">        title (Optional[str]): Title displayed above visualization (default: None)</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a><span class="sd">        go.Figure: Plotly figure object containing:</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">            - 3D scatter plot of atoms colored by element</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">            - Line segments representing bonds</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">            - Interactive menu for toggling labels:</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">                - Element symbols</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">                - Atom indices</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">                - Bond lengths</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">                - Combinations of the above</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">            - Mouse controls for rotation, zoom, and pan</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">        &gt;&gt;&gt; fig = mg.to_plotly(config={</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">        ...     &quot;atom_size&quot;: 12,</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">        ...     &quot;atom_opacity&quot;: 0.9,</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">        ...     &quot;bond_color&quot;: &quot;black&quot;,</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">        ...     &quot;show_grid&quot;: True,</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">        ...     &quot;label_offset&quot;: 20</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">        ... })</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">        &gt;&gt;&gt; fig.show()</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Creating Plotly figure&quot;</span><span class="p">)</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No molecular data to visualize&quot;</span><span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>        <span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>    <span class="n">plot_config</span> <span class="o">=</span> <span class="n">DEFAULT_PLOT_CONFIG</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>    <span class="k">if</span> <span class="n">config</span><span class="p">:</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>        <span class="n">plot_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>    <span class="c1"># Create figure</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_create_atom_trace</span><span class="p">(</span><span class="n">plot_config</span><span class="p">),</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_create_bond_trace</span><span class="p">(</span><span class="n">plot_config</span><span class="p">),</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="p">]</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>    <span class="c1"># Configure axis parameters</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>    <span class="n">axis_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>        <span class="n">showgrid</span><span class="o">=</span><span class="n">plot_config</span><span class="p">[</span><span class="s2">&quot;show_grid&quot;</span><span class="p">],</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>        <span class="n">showbackground</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>        <span class="n">showticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="n">zeroline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>        <span class="n">showspikes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="p">)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="c1"># Build layout</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>    <span class="n">layout</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>        <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>        <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>            <span class="n">xaxis</span><span class="o">=</span><span class="n">axis_params</span><span class="p">,</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>            <span class="n">yaxis</span><span class="o">=</span><span class="n">axis_params</span><span class="p">,</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>            <span class="n">zaxis</span><span class="o">=</span><span class="n">axis_params</span><span class="p">,</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>            <span class="n">annotations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_annotations</span><span class="p">(</span><span class="n">plot_config</span><span class="p">,</span> <span class="n">atom_label_type</span><span class="o">=</span><span class="s2">&quot;element&quot;</span><span class="p">),</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>        <span class="p">),</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="k">else</span> <span class="mi">40</span><span class="p">),</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>        <span class="n">updatemenus</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>            <span class="nb">dict</span><span class="p">(</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>                <span class="n">buttons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_menu_buttons</span><span class="p">(</span><span class="n">plot_config</span><span class="p">),</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>                <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;down&quot;</span><span class="p">,</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                <span class="n">pad</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>            <span class="p">)</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>        <span class="p">],</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>    <span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plotly figure created successfully&quot;</span><span class="p">)</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>    <span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../getting-started/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Getting Started">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Getting Started
              </div>
            </div>
          </a>
        
        
          
          <a href="../cli/" class="md-footer__link md-footer__link--next" aria-label="Next: Command Line">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Command Line
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.footer", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>